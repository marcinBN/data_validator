#major changes in main func from machine2